import { useMemo } from 'react';
import { Space } from "antd";
import { useNavigate } from 'react-router-dom';
import { AiOutlineEdit, AiOutlineDelete } from "react-icons/ai";

export default function useTableColumns() {
  const navigate = useNavigate();

  const columns = useMemo(() => {
    return [
      {{#each $ui}}
      {{#unless (isNilorEmpty this.title)}}
      { title: "{{this.title}}", dataIndex: "{{@key}}", key: "{{@key}}", sorter: {{this.table-column.sorter}}, align: "{{this.table-column.align}}" as "{{this.table-column.align}}", width: {{this.table-column.width}}, 
        render(value: any, record: any) {
        {{#if this.isRef}}
          return record["{{getForeignPropertyName @key}}"]["{{getForeignFieldName this.label}}"];
        {{else}}
          return value;
        {{/if}}
        }
      },
      {{/unless}}
      {{/each}}

      { key: "action", fixed: "right" as "right", width: 150, align: "center" as "center", render(_: any, record: any) {
        return (
          <Space size="middle">
            <a onClick={() => navigate(`${record.id}/edit`)}><AiOutlineEdit className='inline-block relative -top-[2px]' size={16}/> 修 改</a>
            <a onClick={() => navigate(`delete`, { state: {ids: [record.id]} })} className='!text-red-400 hover:!text-red-300'><AiOutlineDelete className='inline-block relative -top-[2px]' size={16}/>删 除</a>
          </Space>
        )
      }},
    ];
  }, [navigate])

  return columns;
}

